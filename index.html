<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>실시간 뉴스 키워드 대시보드</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
            margin-bottom: 20px;
        }
        header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em; /* Default for desktop */
        }
        .last-updated, .download-link {
            text-align: right;
            font-size: 0.9em;
            color: #777;
            margin-top: -10px; /* Pull up slightly */
            margin-bottom: 10px;
        }
        .download-link a {
            color: #007bff;
            text-decoration: none;
        }
        .download-link a:hover {
            text-decoration: underline;
        }
        .content-section {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping for mobile */
            gap: 20px;
        }
        .main-content, .sidebar {
            flex: 1;
            min-width: 300px; /* Minimum width before wrapping */
        }
        .main-content {
            flex: 2; /* Main content takes more space */
        }
        h2 {
            color: #34495e;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
            font-size: 1.8em; /* Default for desktop */
        }
        .wordcloud-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .wordcloud-container img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .news-list ul {
            list-style: none;
            padding: 0;
        }
        .news-list li {
            background-color: #fdfdfd;
            border: 1px solid #e7e7e7;
            border-radius: 5px;
            margin-bottom: 10px;
            padding: 15px;
            transition: transform 0.2s;
        }
        .news-list li:hover {
            transform: translateY(-3px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .news-list li a {
            text-decoration: none;
            color: #2c3e50;
            font-weight: bold;
            font-size: 1.1em; /* Default for desktop */
            display: block;
            margin-bottom: 5px;
        }
        .news-list li a:hover {
            color: #007bff;
        }
        .news-list li p {
            font-size: 0.85em; /* **뉴스 본문 글자 크기 축소** */
            color: #555;
            margin: 0;
        }
        .news-list li .source-date {
            font-size: 0.75em;
            color: #888;
            margin-top: 5px;
            text-align: right;
        }

        /* 반응형 디자인을 위한 미디어 쿼리 */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                margin: 10px auto;
                padding: 15px;
            }
            header h1 {
                font-size: 1.8em;
            }
            h2 {
                font-size: 1.5em;
            }
            .content-section {
                flex-direction: column; /* Stacks columns vertically */
            }
            .main-content, .sidebar {
                min-width: unset; /* Remove min-width for mobile */
                width: 100%; /* Take full width */
            }
            .news-list li a {
                font-size: 1em;
            }
            .news-list li p {
                font-size: 0.8em; /* Even smaller for mobile */
            }
            .last-updated, .download-link {
                text-align: center; /* Center align for mobile */
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>실시간 뉴스 키워드 대시보드</h1>
            <p>선택된 키워드에 대한 최신 뉴스 트렌드를 시각적으로 확인하세요.</p>
        </header>

        <div class="last-updated" id="last-updated">
            마지막 업데이트:
        </div>
        <div class="download-link">
            <a href="https://drive.google.com/file/d/1md68MgTuPPUnCgLmLdj9fJf4p9i8Cjpl/view" target="_blank">
                실행 파일 다운로드(설정 조정 가능, 외부 pc 꺼짐 방지 포함)
            </a>
        </div>

        <div class="content-section">
            <div class="main-content">
                <h2>최신 뉴스 목록</h2>
                <div class="news-list">
                    <ul id="news-articles">
                        <li>뉴스 기사를 불러오는 중...</li>
                    </ul>
                </div>
            </div>
            <div class="sidebar">
                <h2>실시간 인기 키워드</h2>
                <div class="wordcloud-container">
                    <img id="wordcloud-image" src="" alt="워드 클라우드 이미지 로딩 중...">
                </div>
            </div>
        </div>
    </div>

    <script>
        const GIST_RAW_URL = 'https://gist.githubusercontent.com/ryuroot/YOUR_GIST_ID/raw/news_data.json'; // 여기에 실제 Gist ID를 넣으세요!
        const GIST_WC_URL = 'https://gist.githubusercontent.com/ryuroot/YOUR_GIST_ID/raw/wordcloud.png'; // 여기에 실제 Gist ID를 넣으세요!
        
        // ** 중요: 위 두 URL의 'YOUR_GIST_ID' 부분을 실제 Gist ID로 변경해주세요. **
        // 예: https://gist.githubusercontent.com/ryuroot/a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6/raw/news_data.json

        async function fetchData() {
            try {
                const response = await fetch(GIST_RAW_URL + '?t=' + new Date().getTime()); // 캐시 방지
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                return data;
            } catch (error) {
                console.error("뉴스 데이터를 불러오는 데 실패했습니다:", error);
                return null;
            }
        }

        function displayNews(newsData) {
            const newsArticlesDiv = document.getElementById('news-articles');
            newsArticlesDiv.innerHTML = ''; // 기존 내용 지우기

            if (!newsData || newsData.articles.length === 0) {
                newsArticlesDiv.innerHTML = '<li>새로운 뉴스 기사가 없습니다.</li>';
                return;
            }

            newsData.articles.forEach(article => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <a href="${article.link}" target="_blank">${article.title}</a>
                    <p>${article.summary || '내용 요약 없음'}</p>
                    <div class="source-date">${article.source} - ${new Date(article.published_date).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}</div>
                `;
                newsArticlesDiv.appendChild(listItem);
            });

            document.getElementById('last-updated').textContent = `마지막 업데이트: ${new Date(newsData.timestamp).toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}`;
        }

        function displayWordCloud() {
            const wordcloudImage = document.getElementById('wordcloud-image');
            // Gist에서 이미지를 직접 로드 (캐시 방지를 위해 timestamp 추가)
            wordcloudImage.src = GIST_WC_URL + '?t=' + new Date().getTime();
            wordcloudImage.alt = "워드 클라우드 이미지";
        }

        async function initDashboard() {
            const data = await fetchData();
            if (data) {
                displayNews(data);
            }
            displayWordCloud();
            // 5분마다 데이터 새로고침
            setInterval(async () => {
                const updatedData = await fetchData();
                if (updatedData) {
                    displayNews(updatedData);
                }
                displayWordCloud();
            }, 5 * 60 * 1000); // 5분 = 300000 밀리초
        }

        window.onload = initDashboard;
    </script>
</body>
</html>
